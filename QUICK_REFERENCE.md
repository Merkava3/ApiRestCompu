# ‚ö° REFERENCIA R√ÅPIDA - SISTEMA DE CACH√â\n\n**Bookmark this page** üîñ\n\n---\n\n## üéØ LO M√ÅS IMPORTANTE (En 2 minutos)\n\n### Importar\n```python\nfrom ..cache import with_cache, invalidate_cache\n```\n\n### Cachear GET\n```python\n@with_cache(resource='servicios', operation='get_all')\ndef get_servicios():\n    pass\n```\n\n### Invalidar POST/PUT/DELETE\n```python\n@invalidate_cache(resource='servicios')\ndef crear_servicio():\n    pass\n```\n\n**Eso es todo.** El cach√© funciona autom√°ticamente.\n\n---\n\n## üìã PAR√ÅMETROS CLAVE\n\n### @with_cache\n```python\n@with_cache(\n    resource='servicios',       # ‚Üê Nombre del recurso\n    operation='get_all',        # ‚Üê Tipo de operaci√≥n\n    ttl=600                     # ‚Üê Opcional: segundos (default en cache_config.py)\n)\n```\n\n### @invalidate_cache\n```python\n@invalidate_cache(\n    resource='servicios'        # ‚Üê Nombre del recurso a invalidar\n)\n```\n\n### Valores de `resource`\n```python\n'servicios', 'clientes', 'dispositivos', 'productos', \n'inventario', 'facturas', 'proveedores', 'compras', 'usuarios'\n```\n\n### Valores de `operation`\n```python\n'get_all'              # Obtener todos\n'get_by_id'            # Obtener uno\n'get_reporte'          # Reporte especial\n'get_ultimo'           # √öltimos registros\n'get_by_cedula'        # B√∫squeda espec√≠fica\n'get_custom'           # Operaci√≥n personalizada\n```\n\n---\n\n## üîß CONFIGURACI√ìN R√ÅPIDA\n\n### Cambiar TTL (cache_config.py)\n```python\nCACHE_CONFIG = {\n    'servicios': {\n        'get_all': 600,        # 10 minutos\n        'get_reporte': 900,    # 15 minutos\n    }\n}\n```\n\n### Deshabilitar cach√©\n```python\n# En cache_config.py\nCACHE_ENABLED = False\n```\n\n### Aumentar memoria\n```python\n# En cache_config.py\nCACHE_MEMORY_CONFIG = {\n    'max_size': 5000,  # Aumentar a 5000 entradas\n}\n```\n\n---\n\n## üìä MONITOREO R√ÅPIDO\n\n### Ver estad√≠sticas\n```python\nfrom api.app.cache import CacheManager\n\nmgr = CacheManager()\nstats = mgr.strategy.get_stats()\nprint(f\"Cach√©: {stats['usage_percent']:.1f}% usado\")\n```\n\n### Limpiar cach√©\n```python\nfrom api.app.cache import CacheManager\n\nCacheManager().clear()\n```\n\n---\n\n## ‚ùå PROBLEMAS COMUNES\n\n| Problema | Soluci√≥n |\n|----------|----------|\n| Los datos no se actualizan | Falta @invalidate_cache en POST/PUT/DELETE |\n| Endpoint lento | Agregar @with_cache en GET |\n| Endpoint no usa cach√© | Verificar nombre de resource/operation |\n| Mucha memoria | Reducir max_size o TTL |\n| ModuleNotFoundError | Carpeta api/app/cache/ debe existir |\n\n---\n\n## ‚úÖ VALIDACI√ìN\n\n```bash\npython api/test_cache.py\n```\n\nDeber√≠as ver: `‚úì TODOS LOS TESTS PASARON EXITOSAMENTE`\n\nSi no funciona:\n```bash\npip install -r requirements.txt\nfind . -name __pycache__ -type d -exec rm -rf {} +\npython api/test_cache.py\n```\n\n---\n\n## üìö DOCUMENTACI√ìN\n\n| Necesidad | Documento | Tiempo |\n|-----------|-----------|--------|\n| Empezar YA | CACHE_QUICK_START.md | 10 min |\n| Entender qu√© | DEVELOPERS_GUIDE.md | 20 min |\n| Ver ejemplos | CACHE_IMPLEMENTATION_GUIDE.md | 25 min |\n| Detalle t√©cnico | CACHE_SYSTEM_DOCS.md | 45 min |\n| Visualizar | CACHE_FLOW_DIAGRAMS.md | 20 min |\n| B√∫squeda | DOCUMENTATION_INDEX.md | 5 min |\n\n---\n\n## üéØ CHECKLIST ANTES DE COMMIT\n\n- [ ] ¬øAgregu√© @with_cache en GET?\n- [ ] ¬øAgregu√© @invalidate_cache en POST/PUT/DELETE?\n- [ ] ¬øEjecut√© los tests? (8/8 PASS)\n- [ ] ¬øEl resource existe en CACHE_CONFIG?\n- [ ] ¬øEl operation es descriptivo?\n- [ ] ¬øValid√© en desarrollo?\n\n---\n\n## üöÄ COPIAR Y PEGAR\n\n### Template GET\n```python\n@app.route('/items', methods=['GET'])\n@with_cache(resource='items', operation='get_all')\ndef get_items():\n    items = Item.get_all()\n    return {'data': items}\n```\n\n### Template POST\n```python\n@app.route('/items', methods=['POST'])\n@invalidate_cache(resource='items')\ndef create_item():\n    data = request.get_json()\n    item = Item.create(data)\n    return {'data': item}\n```\n\n### Template PUT\n```python\n@app.route('/items/<int:id>', methods=['PUT'])\n@invalidate_cache(resource='items')\ndef update_item(id):\n    data = request.get_json()\n    item = Item.update(id, data)\n    return {'data': item}\n```\n\n### Template DELETE\n```python\n@app.route('/items/<int:id>', methods=['DELETE'])\n@invalidate_cache(resource='items')\ndef delete_item(id):\n    Item.delete(id)\n    return {'message': 'deleted'}\n```\n\n---\n\n## ‚öôÔ∏è CONFIGURACI√ìN AVANZADA\n\n### Cachear con par√°metros\n```python\n@with_cache(\n    resource='servicios',\n    operation='get_by_id',\n    key_params=['servicio_id']  # Clave diferente por ID\n)\ndef get_servicio(servicio_id):\n    pass\n```\n\n### Cach√© manual\n```python\nfrom api.app.cache import CacheManager\n\nmgr = CacheManager()\nkey = mgr.generate_key('servicios', 'custom')\n\nif not mgr.exists(key):\n    result = expensive_operation()\n    mgr.set(key, result, ttl=600)\nelse:\n    result = mgr.get(key)\n\nreturn result\n```\n\n---\n\n## üéì CONCEPTOS\n\n**TTL**: Tiempo de vida en segundos (despu√©s expira)  \n**Resource**: Nombre del modelo/tabla  \n**Operation**: Tipo de b√∫squeda  \n**@with_cache**: Guardar resultado en cach√©  \n**@invalidate_cache**: Limpiar cach√©  \n**CacheManager**: Acceso directo al cach√©  \n**InMemoryCache**: Almacenamiento en RAM  \n**Thread-safe**: Seguro en multi-threading  \n\n---\n\n## üìû PREGUNTAS R√ÅPIDAS\n\n**P: ¬øCu√°nta memoria usa?**  \nR: ~1KB por entrada, m√°ximo 1000 = ~10MB\n\n**P: ¬øEs seguro en producci√≥n?**  \nR: S√≠, totalmente. Con Redis es a√∫n mejor.\n\n**P: ¬øQu√© pasa al reiniciar?**  \nR: Se limpia (cach√© en memoria).\n\n**P: ¬øPuedo cambiar TTL?**  \nR: S√≠, en cache_config.py o directamente en decorador.\n\n**P: ¬øQu√© si falta @invalidate_cache?**  \nR: Datos stale (antiguos). Agregar decorator.\n\n---\n\n## üö® ERRORES T√çPICOS\n\n### Error: ModuleNotFoundError\n```\nNo module named 'api.app.cache'\n```\n‚úÖ **Soluci√≥n**: Carpeta `api/app/cache/` debe existir\n\n### Error: Los datos no se actualizan\n```\nPOST crea nuevo item pero GET retorna datos viejos\n```\n‚úÖ **Soluci√≥n**: Agregar `@invalidate_cache` en POST\n\n### Error: Endpoint muy lento\n```\nAun cacheado, responde lento\n```\n‚úÖ **Soluci√≥n**: Revisar si `@with_cache` est√° agregado\n\n### Error: MemoryError\n```\nSistema se queda sin RAM\n```\n‚úÖ **Soluci√≥n**: Reducir `max_size` en cache_config.py\n\n---\n\n## üéØ NEXT STEPS\n\n1. Leer **CACHE_QUICK_START.md** (10 min)\n2. Ejecutar **python api/test_cache.py** (1 min)\n3. Aplicar decoradores en **1 endpoint** (5 min)\n4. Validar que funciona (2 min)\n5. **Copiar a otros routers** (repite paso 3)\n\n---\n\n## üîó REFERENCIAS\n\n- **C√≥digo**: `api/app/cache/`\n- **Tests**: `api/test_cache.py`\n- **Config**: `api/app/cache/cache_config.py`\n- **Ejemplo**: `api/app/routers/servicios_routers.py`\n- **Docs**: `DOCUMENTATION_INDEX.md`\n\n---\n\n**√öltima actualizaci√≥n**: Enero 21, 2026  \n**Versi√≥n**: 1.0  \n**Status**: ‚úÖ Producci√≥n  \n**Bookmark**: Ctrl+D\n"